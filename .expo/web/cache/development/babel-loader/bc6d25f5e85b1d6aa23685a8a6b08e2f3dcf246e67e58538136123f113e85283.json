{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport utf8 from 'utf8';\nimport base64 from 'base-64';\nimport { useNavigation } from '@react-navigation/native';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar handleLogin = function () {\n  var _ref = _asyncToGenerator(function* () {\n    var navigation = useNavigation();\n    var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      username = _useState2[0],\n      setUsername = _useState2[1];\n    var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      password = _useState4[0],\n      setPassword = _useState4[1];\n    var texto = `${username}:${password}`;\n    var bytes = utf8.encode(texto);\n    var encoded = base64.encode(bytes);\n    console.log('token ' + encoded);\n    try {\n      var response = yield fetch('http://ti.ararangua.sc.gov.br:10000/glpi/apirest.php/initSession', {\n        method: \"GET\",\n        headers: {\n          'App-Token': 'D8lhQKHjvcfLNrqluCoeZXFvZptmDDAGhWl17V2R',\n          'Authorization': 'Basic ' + encoded\n        }\n      });\n      var json = yield response.json();\n      console.log(json);\n      if (!username || !password) {\n        Alert.alert('Erro', 'Preencha todos os campos');\n        return;\n      }\n      if (json && json[0] === 'ERROR_GLPI_LOGIN') {\n        Alert.alert('Erro', 'Nome de usuário ou senha inválidos. Tente novamente.');\n      } else {\n        yield AsyncStorage.setItem('Credenciais', JSON.stringify({\n          username: username,\n          password: password\n        }));\n        navigation.navigate('Serviços');\n      }\n    } catch (error) {\n      console.error(error);\n      Alert.alert('Erro', 'Falha ao autenticar. Verifique suas credenciais e tente novamente.');\n    }\n    var loadStoredCredentials = function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        try {\n          var storedData = yield AsyncStorage.getItem('Credenciais');\n          if (storedData) {\n            var parsedData = JSON.parse(storedData);\n            setUsername(parsedData.username || '');\n            setPassword(parsedData.password || '');\n          }\n        } catch (error) {\n          console.error(\"Erro ao carregar credenciais salvas:\", error);\n        }\n      });\n      return function loadStoredCredentials() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    var saveNewCredentials = function () {\n      var _ref3 = _asyncToGenerator(function* () {\n        try {\n          var newCredentials = {\n            username: username,\n            password: password\n          };\n          yield AsyncStorage.setItem('Credenciais', JSON.stringify(newCredentials));\n          Alert.alert('Sucesso', 'Novas credenciais salvas com sucesso!');\n        } catch (error) {\n          Alert.alert('Erro', 'Falha ao salvar novas credenciais.');\n        }\n      });\n      return function saveNewCredentials() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n    return _jsxs(_Fragment, {\n      children: [_jsx(TextInput, {\n        placeholder: \"Login...\",\n        style: estilos.input,\n        onChangeText: setUsername,\n        value: username\n      }), _jsx(Text, {\n        style: estilos.bar\n      }), _jsx(Text, {\n        style: estilos.texto,\n        children: \"Senha:\"\n      }), _jsx(TextInput, {\n        placeholder: \"Senha...\",\n        style: estilos.input,\n        onChangeText: setPassword,\n        value: password,\n        secureTextEntry: true\n      })]\n    });\n  });\n  return function handleLogin() {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport default handleLogin;","map":{"version":3,"names":["utf8","base64","useNavigation","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","handleLogin","_ref","_asyncToGenerator","navigation","_useState","useState","_useState2","_slicedToArray","username","setUsername","_useState3","_useState4","password","setPassword","texto","bytes","encode","encoded","console","log","response","fetch","method","headers","json","Alert","alert","AsyncStorage","setItem","JSON","stringify","navigate","error","loadStoredCredentials","_ref2","storedData","getItem","parsedData","parse","apply","arguments","saveNewCredentials","_ref3","newCredentials","children","TextInput","placeholder","style","estilos","input","onChangeText","value","Text","bar","secureTextEntry"],"sources":["/home/luigi/Documentos/Projeto/glpi-app-react/src/pages/Components/ApiGlobal.js"],"sourcesContent":["import utf8 from 'utf8'\nimport base64 from 'base-64'\nimport { useNavigation } from '@react-navigation/native'\n\nconst handleLogin = async () => {\n\n    const navigation = useNavigation();\n    const [username, setUsername] = useState('');\n    const [password, setPassword] = useState('');\n    const texto = `${username}:${password}`;\n    const bytes = utf8.encode(texto);\n    const encoded = base64.encode(bytes);\n    console.log('token ' + encoded);\n\n\n    try {\n        const response = await fetch('http://ti.ararangua.sc.gov.br:10000/glpi/apirest.php/initSession', {\n            method: \"GET\",\n            headers: {\n                'App-Token': 'D8lhQKHjvcfLNrqluCoeZXFvZptmDDAGhWl17V2R',\n                'Authorization': 'Basic ' + encoded\n            },\n        });\n        const json = await response.json();\n        console.log(json)\n        if (!username || !password) {\n            Alert.alert('Erro', 'Preencha todos os campos');\n            return;\n        }\n        if (json && json[0] === 'ERROR_GLPI_LOGIN') {\n            Alert.alert('Erro', 'Nome de usuário ou senha inválidos. Tente novamente.');\n        } else {\n            await AsyncStorage.setItem('Credenciais', JSON.stringify({ username, password }));\n            navigation.navigate('Serviços');\n        }\n    } catch (error) {\n        console.error(error);\n        Alert.alert('Erro', 'Falha ao autenticar. Verifique suas credenciais e tente novamente.');\n    }\n\n\n\n    const loadStoredCredentials = async () => {\n        try {\n            const storedData = await AsyncStorage.getItem('Credenciais');\n            if (storedData) {\n                const parsedData = JSON.parse(storedData);\n                setUsername(parsedData.username || '');\n                setPassword(parsedData.password || '');\n            }\n        }\n        catch (error) { console.error(\"Erro ao carregar credenciais salvas:\", error) }\n    };\n\n    const saveNewCredentials = async () => {\n        try {\n            const newCredentials = { username, password };\n            await AsyncStorage.setItem('Credenciais', JSON.stringify(newCredentials));\n            Alert.alert('Sucesso', 'Novas credenciais salvas com sucesso!');\n        } catch (error) { Alert.alert('Erro', 'Falha ao salvar novas credenciais.') }\n    };\n    return (\n        <><TextInput\n            placeholder=\"Login...\"\n            style={estilos.input}\n            onChangeText={setUsername}\n            value={username}\n        />\n            <Text style={estilos.bar}></Text>\n            <Text style={estilos.texto}>\n                Senha:\n            </Text>\n            <TextInput\n                placeholder=\"Senha...\"\n                style={estilos.input}\n                onChangeText={setPassword}\n                value={password}\n                secureTextEntry={true}\n            /></>\n    )\n};\n\nexport default handleLogin;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}