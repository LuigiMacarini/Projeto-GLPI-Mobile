{"ast":null,"code":"","map":{"version":3,"names":[],"sources":["/home/luigi/Área de Trabalho/glpi-app-react/src/pages/Components/addImpress.js"],"sourcesContent":["/*import React, { useState, useEffect } from \"react\";\nimport { View, Text, TextInput, TouchableOpacity, FlatList, StyleSheet } from \"react-native\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { useNavigation } from \"@react-navigation/native\";\n\n\n\nconst TicketCrudPrinter = () => {\n  const [tickets, setTickets] = useState([]);\n  const [expandedItem, setExpandedItem] = useState(null);\n  const [sortOrder, setSortOrder] = useState(\"default\");\n  const [searchId, setSearchId] = useState(\"\");\n  const [sessionToken, setSessionToken] = useState(null);\n  const navigation = useNavigation();\n  const TokenAPI = async () => {\n    const storedSessionToken = await AsyncStorage.getItem('sessionToken');\n    setSessionToken(storedSessionToken);\n\n    const [, tokenPart] = storedSessionToken.replace(/[{}]/g, '').split(':');\n    const TokenObjetc = JSON.parse(tokenPart)\n    return TokenObjetc\n  }\n  useEffect(() => {\n    loadTickets();\n  }, [sortOrder]);\n\n  const loadTickets = async () => {\n    try {\n      const TokenObjetc = await TokenAPI();\n      const response = await fetch(\"http://ti.ararangua.sc.gov.br:10000/glpi/apirest.php/Printer\", {\n        method: \"GET\",\n        headers: {\n          'App-Token': 'D8lhQKHjvcfLNrqluCoeZXFvZptmDDAGhWl17V2R',\n          'Session-Token': TokenObjetc,\n        },\n      });\n\n      if (response.ok) {\n        let data = await response.json();\n        if (sortOrder === \"alphabetical\") {\n          data = data.sort((a, b) => a.name.localeCompare(b.name));\n        }\n        setTickets(data);\n      } else {\n        console.error(\"Falha em acessar a API\");\n      }\n    } catch (error) {\n\n    }\n  };\n  const searchTicketById = () => {\n    if (!searchId.trim()) {\n      loadTickets();\n      return;\n    }\n\n    const foundTicket = tickets.find(ticket => ticket.id === parseInt(searchId));\n    if (foundTicket) {\n      setTickets([foundTicket]);\n    } else {\n      alert(\"Ticket não encontrado\")\n    }\n  };\n  const toggleSortOrder = () => {\n    const newOrder = sortOrder === \"default\" ? \"alphabetical\" : \"default\";\n    setSortOrder(newOrder);\n  };\n\n  const toggleItem = async (id) => {\n    const newExpandedItem = expandedItem === id ? null : id;\n    setExpandedItem(newExpandedItem);\n\n    if (newExpandedItem !== null) {\n      try {\n        await AsyncStorage.setItem('Printer', 'Printer');\n        await AsyncStorage.setItem('selectedTicketId', newExpandedItem.toString());\n      }\n\n      catch (error) {\n        console.error('Erro ao armazenar a página selecionada:', error);\n      }\n    }\n\n    const storedPage = await AsyncStorage.getItem('Printer');\n    console.log(\"Pagina:\", storedPage);\n    const storedId = await AsyncStorage.getItem('selectedTicketId');\n    console.log('ID:', storedId);\n  };\n  const cleanID = () => {\n    setSearchId(\"\")\n  };\n\n  return (\n    <View style={styles.container}>\n      <View style={styles.buttonContainer}>\n        <TouchableOpacity style={styles.filterButton} onPress={toggleSortOrder}>\n          <Text style={styles.filterButtonText}>\n            {sortOrder === \"default\" ? \"ID -> A-Z\" : \"A-Z -> ID\"}\n          </Text>\n        </TouchableOpacity>\n        <View style={styles.searchContainer}>\n          <TextInput\n            style={styles.searchInput}\n            placeholder=\"----\"\n            value={searchId}\n            onChangeText={setSearchId}\n            keyboardType=\"numeric\" />\n          <TouchableOpacity style={styles.searchButton} onPress={searchTicketById}>\n            <Text style={styles.IdText}>Pesquisar ID</Text>\n          </TouchableOpacity>\n        </View>\n      </View>\n      <TouchableOpacity\n        style={styles.cleanButton}\n        onPress={cleanID}>\n        <Text style={styles.cleanButtonText}>Limpar Id</Text>\n      </TouchableOpacity>\n\n      <FlatList\n        data={tickets}\n        keyExtractor={(item) => item.id.toString()}\n        renderItem={({ item }) => (\n          <View style={styles.ticketItem}>\n            <TouchableOpacity onPress={() => toggleItem(item.id)}>\n              <View style={styles.ticketContent}>\n                <Text>{item.name}</Text>\n              </View>\n            </TouchableOpacity>\n            {expandedItem === item.id && (\n              <View style={styles.expandedContent}>\n                <TouchableOpacity onPress={() => navigation.navigate('Chat')}>\n                  <Text>Comentário - {item.contact}</Text>\n                  <Text>Data - {item.date_creation}</Text>\n                </TouchableOpacity>\n              </View>\n            )}\n          </View>)} />\n    </View>);\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    padding: 20,\n    backgroundColor: \"#fff\",\n  },\n  button: {\n    backgroundColor: \"#498DF3\",\n    borderRadius: 6,\n    padding: 10,\n    alignItems: \"center\",\n    marginBottom: 20,\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: 10,\n  },\n  IdText: {\n    color: '#fff'\n  },\n  searchContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'flex-end',\n    bottom: 5\n  },\n  searchInput: {\n    height: 40,\n    width: '20%',\n    borderColor: \"gray\",\n    borderWidth: 1,\n    paddingHorizontal: 10,\n    marginRight: 10,\n  },\n  searchButton: {\n    backgroundColor: \"#3273D4\",\n    borderRadius: 6,\n    padding: 10,\n    alignItems: \"center\",\n  },\n  cleanButton: {\n    borderRadius: 6,\n    padding: 10,\n  },\n  cleanButtonText: {\n    color: \"#484848\",\n    bottom: '50%',\n    textDecorationLine: 'underline',\n    marginLeft: '80%'\n  },\n\n  ticketItem: {\n    flexDirection: \"column\",\n    borderColor: \"#ddd\",\n    borderWidth: 1,\n    padding: 10,\n    marginBottom: 10,\n  },\n  ticketContent: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n\n  contactText: {\n    marginTop: '5%',\n    marginVertical: '5%',\n    flexDirection: \"row\"\n  },\n  expandedContent: {\n    padding: 10,\n    marginTop: 10,\n    backgroundColor: \"#f0f0f0\",\n  },\n  modalContainer: {\n    backgroundColor: \"#fff\",\n    padding: 20,\n    borderRadius: 10,\n  },\n  modalHeader: {\n    fontSize: 18,\n    fontWeight: \"bold\",\n    marginBottom: 10,\n  },\n  filterButton: {\n    backgroundColor: \"#3273D4\",\n    borderRadius: 6,\n    padding: 10,\n    width: '35%',\n    alignItems: \"center\",\n    marginBottom: 10,\n  },\n  filterButtonText: {\n    color: \"#fff\",\n  },\n  modalInput: {\n    height: 40,\n    borderColor: \"gray\",\n    borderWidth: 1,\n    marginBottom: 10,\n    paddingHorizontal: 10,\n  },\n  modalButton: {\n    backgroundColor: \"#3273D4\",\n    borderRadius: 6,\n    padding: 10,\n    alignItems: \"center\",\n  },\n});\n\nexport default TicketCrudPrinter;*/"],"mappings":"","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}