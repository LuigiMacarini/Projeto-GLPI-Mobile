{"ast":null,"code":"var _jsxFileName = \"/home/luigi/\\xC1rea de Trabalho/glpi-app-react/src/pages/Components/Chat.js\";\nimport React, { useEffect, useState } from \"react\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport io from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Chat = () => {\n  const [messages, setMessages] = useState([]);\n  const [inputMessage, setInputMessage] = useState(\"\");\n  const [sessionToken, setSessionToken] = useState(null);\n  const socket = io(\"http://ti.ararangua.sc.gov.br:10000/glpi/apirest.php/Ticket/ITILFollowup/\");\n  useEffect(() => {\n    loadTickets();\n    initChat();\n    fetchMensagens();\n    socket.on(\"message\", message => {\n      setMessages(prevMessages => [...prevMessages, message]);\n    });\n    return () => {\n      socket.off(\"message\");\n      socket.disconnect();\n    };\n  }, []);\n  const initChat = async () => {\n    try {\n      const storedSessionToken = await AsyncStorage.getItem('sessionToken');\n      setSessionToken(storedSessionToken);\n    } catch (error) {\n      console.error(\"Error initializing chat:\", error);\n    }\n  };\n  const fetchMensagens = async () => {\n    try {\n      const [sessionToken, setSessionToken] = useState(null);\n      const storedSessionToken = await AsyncStorage.getItem('sessionToken');\n      setSessionToken(storedSessionToken);\n      const [, tokenPart] = storedSessionToken.replace(/[{}]/g, '').split(':');\n      const TokenObject = JSON.parse(tokenPart);\n      const response = await fetch(`http://ti.ararangua.sc.gov.br:10000/glpi/apirest.php/Ticket/ITILFollowup/${id}`, {\n        method: \"GET\",\n        headers: {\n          'App-Token': 'D8lhQKHjvcfLNrqluCoeZXFvZptmDDAGhWl17V2R',\n          'SessionToken': `${TokenObject}`\n        }\n      });\n      if (response.ok) {} else {\n        console.error(\"Falha em acessar a API\");\n      }\n    } catch (error) {\n      console.error();\n    }\n    return _jsxDEV(View, {\n      style: {\n        flex: 1\n      },\n      children: [_jsxDEV(FlatList, {\n        data: messages,\n        keyExtractor: (item, index) => index.toString(),\n        renderItem: ({\n          item\n        }) => _jsxDEV(View, {\n          children: _jsxDEV(Text, {\n            children: [item.sender, \": \", item.text]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 17\n      }, this), _jsxDEV(View, {\n        style: {\n          flexDirection: \"row\",\n          alignItems: \"center\"\n        },\n        children: [_jsxDEV(TextInput, {\n          style: {\n            flex: 1,\n            borderWidth: 1,\n            borderRadius: 5,\n            padding: 10,\n            marginRight: 10\n          },\n          value: inputMessage,\n          onChangeText: setInputMessage,\n          placeholder: \"Type your message here...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 21\n        }, this), _jsxDEV(TouchableOpacity, {\n          style: {\n            backgroundColor: \"blue\",\n            padding: 10,\n            borderRadius: 5\n          },\n          onPress: sendMessage,\n          children: _jsxDEV(Text, {\n            style: {\n              color: \"white\"\n            },\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 13\n    }, this);\n  };\n};\nexport default Chat;","map":{"version":3,"names":["React","useEffect","useState","AsyncStorage","io","jsxDEV","_jsxDEV","Chat","messages","setMessages","inputMessage","setInputMessage","sessionToken","setSessionToken","socket","loadTickets","initChat","fetchMensagens","on","message","prevMessages","off","disconnect","storedSessionToken","getItem","error","console","tokenPart","replace","split","TokenObject","JSON","parse","response","fetch","id","method","headers","ok","View","style","flex","children","FlatList","data","keyExtractor","item","index","toString","renderItem","Text","sender","text","fileName","_jsxFileName","lineNumber","columnNumber","flexDirection","alignItems","TextInput","borderWidth","borderRadius","padding","marginRight","value","onChangeText","placeholder","TouchableOpacity","backgroundColor","onPress","sendMessage","color"],"sources":["/home/luigi/Área de Trabalho/glpi-app-react/src/pages/Components/Chat.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport io from \"socket.io-client\";\n\nconst Chat = () => {\n    const [messages, setMessages] = useState([]);\n    const [inputMessage, setInputMessage] = useState(\"\");\n    const [sessionToken, setSessionToken] = useState(null);\n    const socket = io(\"http://ti.ararangua.sc.gov.br:10000/glpi/apirest.php/Ticket/ITILFollowup/\");\n    useEffect(() => {\n        loadTickets();\n        initChat();\n        fetchMensagens();\n\n    socket.on(\"message\", message => {\n        setMessages(prevMessages => [...prevMessages, message]);\n    });\n\n    return () => {\n        socket.off(\"message\");\n        socket.disconnect();\n    };\n}, []);\n\nconst initChat = async () => {\n    try {\n        const storedSessionToken = await AsyncStorage.getItem('sessionToken');\n        setSessionToken(storedSessionToken);\n    } catch (error) {\n        console.error(\"Error initializing chat:\", error);\n    }\n};\n\n const fetchMensagens = async () => {\n    try {\n     const [sessionToken, setSessionToken] = useState(null);\n     const storedSessionToken = await AsyncStorage.getItem('sessionToken');\n     setSessionToken(storedSessionToken);\n     const [, tokenPart] = storedSessionToken.replace(/[{}]/g, '').split(':');\n     const TokenObject = JSON.parse(tokenPart)\n     const response = await fetch(`http://ti.ararangua.sc.gov.br:10000/glpi/apirest.php/Ticket/ITILFollowup/${id}`, {\n        method: \"GET\",\n            headers: {\n            'App-Token': 'D8lhQKHjvcfLNrqluCoeZXFvZptmDDAGhWl17V2R',\n            'SessionToken': `${TokenObject}`\n            },\n            });\n    if (response.ok) {\n            } else {\n                console.error(\"Falha em acessar a API\");\n            }\n        } catch (error) {\n            console.error()\n\n        }\n        return (\n            <View style={{ flex: 1 }}>\n                <FlatList\n                    data={messages}\n                    keyExtractor={(item, index) => index.toString()}\n                    renderItem={({ item }) => (\n                        <View>\n                            <Text>{item.sender}: {item.text}</Text>\n                        </View>\n                    )}\n                />\n                <View style={{ flexDirection: \"row\", alignItems: \"center\" }}>\n                    <TextInput\n                        style={{ flex: 1, borderWidth: 1, borderRadius: 5, padding: 10, marginRight: 10 }}\n                        value={inputMessage}\n                        onChangeText={setInputMessage}\n                        placeholder=\"Type your message here...\"\n                    />\n                    <TouchableOpacity\n                        style={{ backgroundColor: \"blue\", padding: 10, borderRadius: 5 }}\n                        onPress={sendMessage}\n                    >\n                        <Text style={{ color: \"white\" }}>Send</Text>\n                    </TouchableOpacity>\n                </View>\n            </View>\n        );\n    };\n}\nexport default Chat;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}