{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport utf8 from 'utf8';\nimport base64 from 'base-64';\nimport { useNavigation } from '@react-navigation/native';\nvar handleLogin = function () {\n  var _ref = _asyncToGenerator(function* () {\n    var navigation = useNavigation();\n    var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      username = _useState2[0],\n      setUsername = _useState2[1];\n    var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      password = _useState4[0],\n      setPassword = _useState4[1];\n    var texto = `${username}:${password}`;\n    var bytes = utf8.encode(texto);\n    var encoded = base64.encode(bytes);\n    console.log('token ' + encoded);\n    try {\n      var response = yield fetch('http://ti.ararangua.sc.gov.br:10000/glpi/apirest.php/initSession', {\n        method: \"GET\",\n        headers: {\n          'App-Token': 'D8lhQKHjvcfLNrqluCoeZXFvZptmDDAGhWl17V2R',\n          'Authorization': 'Basic ' + encoded\n        }\n      });\n      var json = yield response.json();\n      console.log(json);\n      if (!username || !password) {\n        Alert.alert('Erro', 'Preencha todos os campos');\n        return;\n      }\n      if (json && json[0] === 'ERROR_GLPI_LOGIN') {\n        Alert.alert('Erro', 'Nome de usuário ou senha inválidos. Tente novamente.');\n      } else {\n        yield AsyncStorage.setItem('Credenciais', JSON.stringify({\n          username: username,\n          password: password\n        }));\n        navigation.navigate('Serviços');\n      }\n    } catch (error) {\n      console.error(error);\n      Alert.alert('Erro', 'Falha ao autenticar. Verifique suas credenciais e tente novamente.');\n    }\n  });\n  return function handleLogin() {\n    return _ref.apply(this, arguments);\n  };\n}();\nvar loadStoredCredentials = function () {\n  var _ref2 = _asyncToGenerator(function* () {\n    try {\n      var storedData = yield AsyncStorage.getItem('Credenciais');\n      if (storedData) {\n        var parsedData = JSON.parse(storedData);\n        setUsername(parsedData.username || '');\n        setPassword(parsedData.password || '');\n      }\n    } catch (error) {\n      console.error(\"Erro ao carregar credenciais salvas:\", error);\n    }\n  });\n  return function loadStoredCredentials() {\n    return _ref2.apply(this, arguments);\n  };\n}();\nvar saveNewCredentials = function () {\n  var _ref3 = _asyncToGenerator(function* () {\n    try {\n      var newCredentials = {\n        username: username,\n        password: password\n      };\n      yield AsyncStorage.setItem('Credenciais', JSON.stringify(newCredentials));\n      Alert.alert('Sucesso', 'Novas credenciais salvas com sucesso!');\n    } catch (error) {\n      Alert.alert('Erro', 'Falha ao salvar novas credenciais.');\n    }\n  });\n  return function saveNewCredentials() {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport default handleLogin;","map":{"version":3,"names":["utf8","base64","useNavigation","handleLogin","_ref","_asyncToGenerator","navigation","_useState","useState","_useState2","_slicedToArray","username","setUsername","_useState3","_useState4","password","setPassword","texto","bytes","encode","encoded","console","log","response","fetch","method","headers","json","Alert","alert","AsyncStorage","setItem","JSON","stringify","navigate","error","apply","arguments","loadStoredCredentials","_ref2","storedData","getItem","parsedData","parse","saveNewCredentials","_ref3","newCredentials"],"sources":["/home/luigi/Documentos/Projeto/glpi-app-react/src/pages/Components/ApiGlobal.js"],"sourcesContent":["import utf8 from 'utf8'\nimport base64 from 'base-64'\nimport { useNavigation } from '@react-navigation/native'\n\nconst handleLogin = async () => {\n\nconst navigation = useNavigation();\n    const [username, setUsername] = useState('');\n    const [password, setPassword] = useState('');\n    const texto = `${username}:${password}`;\n    const bytes = utf8.encode(texto);\n    const encoded = base64.encode(bytes);\n    console.log('token ' + encoded);\n\n\n    try {\n        const response = await fetch('http://ti.ararangua.sc.gov.br:10000/glpi/apirest.php/initSession', {\n            method: \"GET\",\n            headers: {\n                'App-Token': 'D8lhQKHjvcfLNrqluCoeZXFvZptmDDAGhWl17V2R',\n                'Authorization': 'Basic ' + encoded\n            },\n        });\n        const json = await response.json();\n        console.log(json)\n        if (!username || !password) {\n            Alert.alert('Erro', 'Preencha todos os campos');\n            return;\n        }\n        if (json && json[0] === 'ERROR_GLPI_LOGIN') {\n            Alert.alert('Erro', 'Nome de usuário ou senha inválidos. Tente novamente.');\n        } else {\n            await AsyncStorage.setItem('Credenciais', JSON.stringify({ username, password }));\n            navigation.navigate('Serviços');\n        }\n    } catch (error) {\n        console.error(error);\n        Alert.alert('Erro', 'Falha ao autenticar. Verifique suas credenciais e tente novamente.');\n    }\n\n};\n\nconst loadStoredCredentials = async () => {\n    try {\n        const storedData = await AsyncStorage.getItem('Credenciais');\n        if (storedData) {\n            const parsedData = JSON.parse(storedData);\n            setUsername(parsedData.username || '');\n            setPassword(parsedData.password || '');\n        }\n    }\n    catch (error) { console.error(\"Erro ao carregar credenciais salvas:\", error) }\n};\n\nconst saveNewCredentials = async () => {\n    try {\n        const newCredentials = { username, password };\n        await AsyncStorage.setItem('Credenciais', JSON.stringify(newCredentials));\n        Alert.alert('Sucesso', 'Novas credenciais salvas com sucesso!');\n    } catch (error) { Alert.alert('Erro', 'Falha ao salvar novas credenciais.') }\n};\n\nexport default handleLogin;"],"mappings":";;AAAA,OAAOA,IAAI,MAAM,MAAM;AACvB,OAAOC,MAAM,MAAM,SAAS;AAC5B,SAASC,aAAa,QAAQ,0BAA0B;AAExD,IAAMC,WAAW;EAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,aAAY;IAEhC,IAAMC,UAAU,GAAGJ,aAAa,CAAC,CAAC;IAC9B,IAAAK,SAAA,GAAgCC,QAAQ,CAAC,EAAE,CAAC;MAAAC,UAAA,GAAAC,cAAA,CAAAH,SAAA;MAArCI,QAAQ,GAAAF,UAAA;MAAEG,WAAW,GAAAH,UAAA;IAC5B,IAAAI,UAAA,GAAgCL,QAAQ,CAAC,EAAE,CAAC;MAAAM,UAAA,GAAAJ,cAAA,CAAAG,UAAA;MAArCE,QAAQ,GAAAD,UAAA;MAAEE,WAAW,GAAAF,UAAA;IAC5B,IAAMG,KAAK,GAAI,GAAEN,QAAS,IAAGI,QAAS,EAAC;IACvC,IAAMG,KAAK,GAAGlB,IAAI,CAACmB,MAAM,CAACF,KAAK,CAAC;IAChC,IAAMG,OAAO,GAAGnB,MAAM,CAACkB,MAAM,CAACD,KAAK,CAAC;IACpCG,OAAO,CAACC,GAAG,CAAC,QAAQ,GAAGF,OAAO,CAAC;IAG/B,IAAI;MACA,IAAMG,QAAQ,SAASC,KAAK,CAAC,kEAAkE,EAAE;QAC7FC,MAAM,EAAE,KAAK;QACbC,OAAO,EAAE;UACL,WAAW,EAAE,0CAA0C;UACvD,eAAe,EAAE,QAAQ,GAAGN;QAChC;MACJ,CAAC,CAAC;MACF,IAAMO,IAAI,SAASJ,QAAQ,CAACI,IAAI,CAAC,CAAC;MAClCN,OAAO,CAACC,GAAG,CAACK,IAAI,CAAC;MACjB,IAAI,CAAChB,QAAQ,IAAI,CAACI,QAAQ,EAAE;QACxBa,KAAK,CAACC,KAAK,CAAC,MAAM,EAAE,0BAA0B,CAAC;QAC/C;MACJ;MACA,IAAIF,IAAI,IAAIA,IAAI,CAAC,CAAC,CAAC,KAAK,kBAAkB,EAAE;QACxCC,KAAK,CAACC,KAAK,CAAC,MAAM,EAAE,sDAAsD,CAAC;MAC/E,CAAC,MAAM;QACH,MAAMC,YAAY,CAACC,OAAO,CAAC,aAAa,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEtB,QAAQ,EAARA,QAAQ;UAAEI,QAAQ,EAARA;QAAS,CAAC,CAAC,CAAC;QACjFT,UAAU,CAAC4B,QAAQ,CAAC,UAAU,CAAC;MACnC;IACJ,CAAC,CAAC,OAAOC,KAAK,EAAE;MACZd,OAAO,CAACc,KAAK,CAACA,KAAK,CAAC;MACpBP,KAAK,CAACC,KAAK,CAAC,MAAM,EAAE,oEAAoE,CAAC;IAC7F;EAEJ,CAAC;EAAA,gBApCK1B,WAAWA,CAAA;IAAA,OAAAC,IAAA,CAAAgC,KAAA,OAAAC,SAAA;EAAA;AAAA,GAoChB;AAED,IAAMC,qBAAqB;EAAA,IAAAC,KAAA,GAAAlC,iBAAA,CAAG,aAAY;IACtC,IAAI;MACA,IAAMmC,UAAU,SAASV,YAAY,CAACW,OAAO,CAAC,aAAa,CAAC;MAC5D,IAAID,UAAU,EAAE;QACZ,IAAME,UAAU,GAAGV,IAAI,CAACW,KAAK,CAACH,UAAU,CAAC;QACzC5B,WAAW,CAAC8B,UAAU,CAAC/B,QAAQ,IAAI,EAAE,CAAC;QACtCK,WAAW,CAAC0B,UAAU,CAAC3B,QAAQ,IAAI,EAAE,CAAC;MAC1C;IACJ,CAAC,CACD,OAAOoB,KAAK,EAAE;MAAEd,OAAO,CAACc,KAAK,CAAC,sCAAsC,EAAEA,KAAK,CAAC;IAAC;EACjF,CAAC;EAAA,gBAVKG,qBAAqBA,CAAA;IAAA,OAAAC,KAAA,CAAAH,KAAA,OAAAC,SAAA;EAAA;AAAA,GAU1B;AAED,IAAMO,kBAAkB;EAAA,IAAAC,KAAA,GAAAxC,iBAAA,CAAG,aAAY;IACnC,IAAI;MACA,IAAMyC,cAAc,GAAG;QAAEnC,QAAQ,EAARA,QAAQ;QAAEI,QAAQ,EAARA;MAAS,CAAC;MAC7C,MAAMe,YAAY,CAACC,OAAO,CAAC,aAAa,EAAEC,IAAI,CAACC,SAAS,CAACa,cAAc,CAAC,CAAC;MACzElB,KAAK,CAACC,KAAK,CAAC,SAAS,EAAE,uCAAuC,CAAC;IACnE,CAAC,CAAC,OAAOM,KAAK,EAAE;MAAEP,KAAK,CAACC,KAAK,CAAC,MAAM,EAAE,oCAAoC,CAAC;IAAC;EAChF,CAAC;EAAA,gBANKe,kBAAkBA,CAAA;IAAA,OAAAC,KAAA,CAAAT,KAAA,OAAAC,SAAA;EAAA;AAAA,GAMvB;AAED,eAAelC,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}